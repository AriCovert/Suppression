<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- Définition de l'encodage -->
    <meta charset="UTF-8">

    <!-- Permet un affichage adapté aux écrans mobiles -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Système</title>

    <style>
        /* 
           Reset basique :
           - Supprime marges et paddings par défaut
           - Définit fond noir
           - Définit couleur de texte type terminal
           - Empêche le scroll
        */
        html, body {
            margin: 0;
            padding: 0;
            background: #ffffff;
            color: #000000;
            font-family: monospace;
            height: 100%;
            overflow: hidden;
        }

        /*
           Conteneur principal :
           - Flexbox centré verticalement et horizontalement
           - Occupe toute la hauteur
        */
        #screen {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh; /* vh = hauteur de vue, indispensable pour centrer verticalement */
            width: 100vw;  /* occupe toute la largeur */
            text-align: center;
        }

        /* AJOUT : Style pour masquer la souris pendant la blague */
        .no-cursor {
            cursor: none;
        }

        /* Classe utilitaire pour cacher un élément */
        .hidden {
            display: none !important;
        }

        /* Conteneur de la barre de progression */
        .progress-container {
            width: 300px;      /* largeur fixe */
            max-width: 90vw;   /* sécurité mobile */
            height: 20px;
            border: 1px solid #000000;
            margin-top: 20px;
        }

        /* Barre de progression interne :
           - Largeur modifiée dynamiquement en JS */
        .progress-bar {
            height: 100%;
            width: 0%;
            background: #000000;
            transition: width 0.5s linear;
        }
        
        /* Style de la boîte de confirmation */
        #confirmBox {
            margin-top: 30px;
            border: 1px solid #000000;
            padding: 20px;
            width: 80%;
        }
        
        button {
            background: #ffffff;
            color: #000000;
            border: 1px solid #000000;
            padding: 8px 20px;
            margin: 10px;
            cursor: pointer;
        }

        button:hover {
            background: #B0B0B0;
        }

        /* Animation de disparition progressive */
        .fade {
            animation: fadeOut 2s forwards;
        }

        /* Définition de l’animation fadeOut */
        @keyframes fadeOut {
            to { opacity: 0; }
        }
    </style>
</head>

<body>

<!--  Conteneur principal affiché à l’écran ->
<div id="screen">

    <div id="startScreen"> <!-- Mets en plein écran -->
        <button onclick="launchPrank()">Démarrer</button>
    </div>
    
    <!-- Message principal (arrêt / redémarrage) -->
    <div id="message" class="hidden">Arrêt du système...</div>

    <!-- Section de réinitialisation
         Cachée au départ -->
    <div id="progressSection" class="hidden">
        <div>Data suppression...</div>

        <!-- Conteneur visuel -->
        <div class="progress-container">
            <!-- Barre interne animée en JS -->
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <!-- Pourcentage affiché -->
        <div id="percent">0%</div>
    
    <!-- Boîte de confirmation (cachée au départ) -->
        <div id="confirmBox" class="hidden">
            <div>Êtes-vous sûr de vouloir tout supprimer ?</div>
            <div>Cette action est définitive.</div>
            <button onclick="handleChoice()">Oui</button>
            <button onclick="handleChoice()">Non</button>
        </div>
    </div>
    
    <!-- Message final -->
    <div id="finalMessage" class="hidden"></div>

</div>

<script>
    /* Récupération des éléments HTML
       Cela permet de les manipuler via JavaScript */
    
    const startScreen = document.getElementById("startScreen");
    const message = document.getElementById("message");
    const progressSection = document.getElementById("progressSection");
    const progressBar = document.getElementById("progressBar");
    const percent = document.getElementById("percent");
    const confirmBox = document.getElementById("confirmBox");
    const finalMessage = document.getElementById("finalMessage");

    /**
     * Cette fonction est appelée par le bouton.
     * Elle gère le plein écran ET lance la séquence.
     */
    function launchPrank() {
        // 1. Passage en plein écran
        enterFullscreen();
        
        // 2. On cache le bouton de départ
        if(startScreen) {
            startScreen.classList.add("hidden");
        }
        
        // 3. On masque le curseur pour 'effet "perte de contrôle"
        document.body.classList.add("no-cursor");

        // 4. On lance la séquence originale
        simulateShutdown();
    }
    
    /**
     * Gère la compatibilité du plein écran sur différents navigateurs
     */
    function enterFullscreen() {
        const doc = document.documentElement;
        if (doc.requestFullscreen) {
            doc.requestFullscreen();
        } else if (doc.webkitRequestFullscreen) { /* Safari / Chrome Mobile */
            doc.webkitRequestFullscreen();
        } else if (doc.msRequestFullscreen) { /* IE11 */
            doc.msRequestFullscreen();
        }
    }

    /* Simulation de l’arrêt du système */
    function simulateShutdown() {

        // Affiche le premier message qui était caché
        message.classList.remove("hidden");
        // Modification du texte affiché
        message.textContent = "Lien vers suppression totale activé";

        // Une fois "éteint", on lance le redémarrage
        setTimeout(() => {
            message.classList.add("hidden");
            simulateReboot();
        }, 3000);
    }

    /* Simulation du redémarrage */
    function simulateReboot() {

        // On réaffiche le message
        message.classList.remove("hidden");

        message.textContent = "Suppression des données de l'appareil...";

        // Après quelques secondes, on passe à la réinitialisation
        setTimeout(() => {
            message.classList.add("hidden");
            simulateReset();
        }, 3000);
    }

    /* Simulation d’une réinitialisation avec progression */
    function simulateReset() {

        // Affiche la section progression
        progressSection.classList.remove("hidden");

        let progress = 0;

        /* Intervalle qui augmente progressivement la barre
           Math.random() donne un effet moins prévisible */
        const interval = setInterval(() => {
            // Incrément aléatoire pour plus de réalisme
            progress += Math.random() * 3;

            if (progress >= 100) {
                progress = 100;
                clearInterval(interval); // Stop l’intervalle

                // Affichage de la boîte de confirmation
                setTimeout(() => {
                    confirmBox.classList.remove("hidden");
                    // On réaffiche la souris pour qu'il puisse cliquer sur "Oui/Non"
                    document.body.classList.remove("no-cursor");
                }, 800);
            }

            // Mise à jour visuelle
            progressBar.style.width = progress + "%";
            percent.textContent = Math.floor(progress) + "%";

        }, 600);
    }
    
    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    /* Fonction appelée pour les deux boutons
       Peu importe le bouton cliqué,
       la réponse affichée sera toujours NON. */
    async function handleChoice() {

        confirmBox.classList.add("hidden");
        progressSection.classList.add("hidden");
        finalMessage.classList.remove("hidden");

        // On recache le curseur pour le message de fin 
        document.body.classList.add("no-cursor");

        finalMessage.innerHTML = "";
        finalMessage.innerHTML += "Selected answer : OUI<br><br>";
        await sleep(500);
        
        finalMessage.innerHTML += "Factory restore ended.<br><br>";
        await sleep(300);
        
        finalMessage.innerHTML += "Réussite de la suppression des données.<br>";
        finalMessage.innerHTML += "Retour à la configuration d'usine terminé.";
    
    }

    /* IMPORTANT : On enlève simulateShutdown d'ici.
       On ne laisse que enterFullscreen si tu veux tenter, 
       mais c'est le bouton qui fera tout le travail maintenant.
    */
    window.onload = () => {
        /* On ne lance rien automatiquement pour éviter que les messages apparaissent
        avant que le boutton démarer soit lancer
        enterFullscreen();     // Tentative plein écran
        simulateShutdown();    // Lancement séquence */
    };
</script>

</body>
</html>




